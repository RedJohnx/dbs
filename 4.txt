-- 1. Create SUPPLIER
CREATE TABLE SUPPLIER (
    Sid INT,
    Sname VARCHAR(20),
    Address VARCHAR(50),
    PRIMARY KEY (Sid)
);

-- 2. Create PART
CREATE TABLE PART (
    PID INT,
    Pname VARCHAR(20),
    Color VARCHAR(10),
    PRIMARY KEY (PID)
);

-- 3. Create SHIPMENT
CREATE TABLE SHIPMENT (
    Sid INT,
    PID INT,
    Cost INT,
    PRIMARY KEY (Sid, PID),
    FOREIGN KEY (Sid) REFERENCES SUPPLIER(Sid),
    FOREIGN KEY (PID) REFERENCES PART(PID)
);

-- Insert Suppliers
INSERT INTO SUPPLIER VALUES (1, 'Acme Corp', 'New York');
INSERT INTO SUPPLIER VALUES (2, 'Globex', 'California');
INSERT INTO SUPPLIER VALUES (3, 'S3_Services', 'Texas');
INSERT INTO SUPPLIER VALUES (4, 'Initech', 'Texas');

-- Insert Parts
INSERT INTO PART VALUES (10, 'Bolt', 'Green');
INSERT INTO PART VALUES (11, 'Nut', 'Red');
INSERT INTO PART VALUES (12, 'Screw', 'Blue');
INSERT INTO PART VALUES (13, 'Washer', 'Green');

-- Insert Shipments
INSERT INTO SHIPMENT VALUES (1, 10, 50); -- Acme sends Green Bolt
INSERT INTO SHIPMENT VALUES (2, 10, 55); -- Globex sends Green Bolt
INSERT INTO SHIPMENT VALUES (3, 11, 20); -- S3 sends Red Nut
INSERT INTO SHIPMENT VALUES (3, 12, 30); -- S3 sends Blue Screw
INSERT INTO SHIPMENT VALUES (4, 13, 10); -- Initech sends Green Washer

SELECT DISTINCT S.Sid 
FROM SHIPMENT S, PART P
WHERE S.PID = P.PID 
AND P.Color = 'Green';

SELECT S.Sname, COUNT(Sh.PID) AS Total_Parts
FROM SUPPLIER S, SHIPMENT Sh
WHERE S.Sid = Sh.Sid
GROUP BY S.Sname;

UPDATE PART 
SET Color = 'Yellow' 
WHERE PID IN (
    SELECT PID 
    FROM SHIPMENT 
    WHERE Sid = 3
);

